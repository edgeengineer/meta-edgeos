#!/bin/bash

# EdgeOS services status

# Colors
GREEN='\033[0;32m'
RED='\033[0;31m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

echo "Services Status:"

# Function to check service status
check_service() {
    SERVICE_NAME=$1
    DISPLAY_NAME=$2
    
    if systemctl is-active --quiet "$SERVICE_NAME" 2>/dev/null; then
        echo -e "  ${DISPLAY_NAME}: ${GREEN}● running${NC}"
    elif systemctl is-enabled --quiet "$SERVICE_NAME" 2>/dev/null; then
        echo -e "  ${DISPLAY_NAME}: ${YELLOW}○ enabled (not running)${NC}"
    else
        # Service might not exist, don't show it
        return
    fi
}

# Check critical services
check_service "sshd" "SSH"
check_service "ssh" "SSH"  # Some systems use 'ssh' instead of 'sshd'
check_service "systemd-networkd" "Network"
check_service "systemd-resolved" "DNS"
check_service "usb-gadget" "USB Gadget"
check_service "avahi-daemon" "mDNS"
check_service "systemd-timesyncd" "Time Sync"

echo